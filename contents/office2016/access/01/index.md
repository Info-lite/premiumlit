---
layout: page
title: Accessの概要とテーブル
date: 2016-03-16 09:50:30 +0900
purposes:
    - データベースソフトについて学ぶ
    - Microsoft Accessの基本操作を学ぶ
    - 新しいテーブルを作成する
---


<div class="panel panel-info">
<div class="panel-body">
今回使うファイルです。ダウンロードしてください。
<ul>
<li><a href="../assets/Clist(fin).accdb">Clist(fin).accdb</a></li>
<li><a href="../assets/Clist.xlsx">Clist.xlsx</a></li>
<li><a href="../assets/gradetype.accdb">gradetype.accdb</a></li>
<li><a href="../assets/congress.xlsx">congress.xlsx</a></li>
<li><a href="../assets/membertype.accdb">membertype.accdb</a></li>
</ul>
</div>
</div>


Microsoft Accessについて
------------------------

{% screenshot accesslogo.png "スプラッシュスクリーン" %}

Microsoft Accessは、Microsoft社が開発したリレーション（関係）型データベースソフトウェアです。
大量のデータを入力、保存することができ、そのデータを必要に応じた形で表示したり、印刷したりすることができます。

大きな特徴は、データ間のリレーションシップ（関係）に基づいて、データを処理することができるということです。


### Microsoft Excelとの違い

Microsoft Officeには、Accessの他にデータを操作するソフトウェアとしてExcelがあります。しかし、Accessはデータベースソフトウェアと呼ばれる一方で、Excelは表計算ソフトと呼ばれ、それぞれ特長を持っています。

-   Excelの特長
    -   データはセルに直接入力する
    -   自由に入力することができる
    -   計算はセルに直接計算式を入力する
    -   シートに表された形で印刷する
-   Accessの特長
    -   データはテーブルに入力する
    -   同じ列には同じ型のデータしか入力することはできない
    -   クエリを使うことによって、複数のデータテーブルを組み合わせ、様々な形で設定できる
    -   計算にはクエリを使用する
    -   レポートで任意の形で印刷することができる


Microsoft Accessの基本操作
--------------------------


### ウィンドウ構成

{% screenshot window.png "各部の名称" %}


### クイックアクセスツールバー

{% screenshot quick.png "クイックアクセスツールバー" %}

よく使うコマンドを表示しておくことができます。
初期設定では、![](./pic/quicksave.png)（上書き保存）、
![元に戻す](./pic/quickreturn.png)（元に戻す）、![繰り返す](./pic/quickrepeat.png)（繰り返す）が表示されています。

![](./pic/quick_more.png)をクリックすると、表示するコマンドのカスタマイズができます。


### リボン

データベースを作成していく際によく利用するコマンドを割り当てたボタンが機能ごとにパネルに分類され、配置されています。

リボン上部のタブ状になった[ホーム]、[作成]、[外部データ]、[データベース ツール]をクリックすることによって、 各機能のパネルに切り替えることができます。
もしくは、カーソルがリボン上にあるときにホイールを回すと、切り替えることができます。

-   ホーム：フォントの設定や並び替え、検索などを行う事が出来ます。

{% screenshot ribbon1.png "ホームリボン" %}

-   作成：テーブル、フォーム、レポートおよびクエリやマクロはここで作成する事が出来ます。

{% screenshot ribbon2.png "作成リボン" %}

-   外部データ：他のAccessやExcelなどのデータをインポートしたり、ExcelやPDF形式のファイルにエクスポートしたりできます。

{% screenshot ribbon3.png "外部データリボン" %}

-   データベース ツール：マクロの設定や、リレーションシップの設定などを行う事が出来ます。

{% screenshot ribbon4.png "データベース ツール リボン" %}

パネルの右下にある ![](./pic/details.png) をクリックすと、より詳しく各項目を設定することができます。

{% screenshot ribbon_details.png "項目詳細設定のアイコン" %}

{% screenshot fontwindow.png "セルの表示 詳細設定" %}

また、カーソルを使用したいコマンドの上で静止させると、そのコマンドの説明を見ることができます。


### Microsoft Accessの起動

[スタート] - [すべてのプログラム] - [Microsoft Office] - [Access 2016]をクリックします。

{% screenshot home.png "起動画面" %}


### データベースを開く

&#9312; [他のファイルを開く] - [開く]をクリック - 先ほど保存した"Clist(fin)"を選択 - [開く]をクリックします。

{% screenshot open1.png "開く" %}

{% screenshot open2.png "セキュリティの警告表示" %}

&#9313; セキュリティの警告が出ているので解除します。[コンテンツの有効化]をクリックします。

{% screenshot security1.png "セキュリティの警告表示 コンテンツの有効化" %}


### ナビゲーションウィンドウの操作

Access2016では、ウィンドウ左に表示される"ナビゲーション ウィンドウ"を使って テーブルやフォームなどの一覧を表示させることができます。

カテゴライズの方法とフィルタの設定がここで行えます。

{% screenshot navi1.png "ナビゲーション ウィンドウ" %}


### テーブルを開く

ここからは、Accessの基本である「テーブル」「フォーム」「クエリ」「レポート」の開き方を見ていきます。
ナビゲーションウィンドウの各オブジェクトは名前をダブルクリックすることで開きます。

テーブルは、データを蓄積し、表として保存しておくものです。同じ行のデータはそれぞれ対応関係にあります。
列（フィールド）はデータの各項目を表しており、特定の型が設定されます。その型以外のデータは保存することはできません。

&#9312; すべてのAccessオブジェクトから[サークル名簿]を開きます。

{% screenshot readlist1.png "ナビゲーションウィンドウ [サークル名簿]" %}

{% screenshot readlist2.png "[サークル名簿] 内容" %}

&#9313; [ホーム]リボン（もしくは[データシート]リボン） - [表示] - ![](./pic/designview.png)（デザインビュー）をクリックしてデザインビューに切り替えます。

{% screenshot readlist3.png "[表示] デザインビュー アイコンの位置" %}

{% screenshot readlist4.png "デザインビュー" %}

&#9314; デザインビューに切り替わりました。デザインビューは、テーブル以外にもあり、レイアウトの変更やフィールドの設定変更などを行うことができます。

&#9315; [ホーム]リボン（もしくは[デザイン]リボン） - [表示] - ![](./pic/databaseview.png)（データシートビュー）をクリックすると、元に戻ります。

{% screenshot readlist5.png "[表示] データシートビュー アイコンの位置" %}


### フォーム

フォームは、テーブルに保存されているデータを、また入力用のウィンドウをどのように表示するか設定するものです。
フォームを作成すると1つのレコードを1つのウィンドウに表示することができるので、入力作業を効率的に行うことができます。

&#9312; すべてのAccessオブジェクトから[会員情報]を開きます。

{% screenshot readinfo1.png "ナビゲーションウィンドウ [会員情報]" %}

{% screenshot readinfo2.png "[会員情報] 内容" %}

&#9313; [ホーム]リボン - [表示] - ![](./pic/layoutview.png)の（[表示]）の部分をクリックして、[デザインビュー]をクリックします。

{% screenshot readinfo3.png "[表示] デザインビュー アイコン" %}

{% screenshot readinfo4.png "デザインビュー" %}

&#9314; デザインビューに切り替わりました。[ホーム]リボン（もしくは[デザイン]リボン） - [表示] - ![](./pic/formview.png)（データシートビュー）をクリックすると、元に戻ります。

{% screenshot readinfo5.png "[表示] フォームビュー アイコンの位置" %}


### クエリ

クエリは、テーブルに蓄積されたデータをどのような形に加工するか設定するものです。
複数のテーブルの必要な部分だけを引き出したり、関連性のあるデータ同士をリレーションシップによって接続することなどができます。

&#9312; すべてのAccessオブジェクトから[入会日と所属]を開きます。

{% screenshot readcourse1.png "ナビゲーションウィンドウ [入会日と所属]" %}

{% screenshot readcourse2.png "[入会日と所属] 内容" %}

&#9313; [ホーム]リボン - [表示] - ![](./pic/designview.png)（デザインビュー）をクリックしてデザインビューに切り替えます。

{% screenshot readcourse3.png "[表示] デザインビュー アイコン" %}

{% screenshot readcourse4.png "デザインビュー" %}

&#9314; デザインビューに切り替わりました。
[ホーム]リボン（もしくは[デザイン]リボン） - [表示] - ![](./pic/databaseview.png)（データシートビューもしくは[実行]）をクリックすると、元に戻ります。

{% screenshot readcourse5.png "[表示] データシートビュー アイコン" %}


### レポート

レポートは、クエリなどでデータの集合をどのようなデザインで表示するかを設定するものです。
フォームとの違いは、フォームは 1つのレコードについて各項目を表示するのに対し、レポートはデータの抽出や集計を実行した結果の報告書を作成したりできます。

&#9312; すべてのAccessオブジェクトのフォームにある[入会日リスト]を開きます。

{% screenshot readjoin1.png "ナビゲーションウィンドウ [入会日リスト]" %}

{% screenshot readjoin2.png "[入会日リスト] 内容" %}

&#9313; [ホーム]リボン - [表示] - ![](./pic/layoutview.png)の（表示）の部分をクリックして、[デザインビュー]に切り替えます。

{% screenshot readjoin3.png "[表示] デザインビュー アイコン" %}

{% screenshot readjoin4.png "デザインビュー" %}

&#9314; デザインビューに切り替わりました。
[ホーム]リボン（もしくは[デザイン]リボン） - [表示] - ![](./pic/reportview.png)（[データシートビュー]）をクリックすると、元に戻ります。

{% screenshot readjoin5.png "[表示] データシートビュー アイコンの位置" %}


データベースの作成
------------------

### 新しいデータベースの作成

&#9312; [ファイルメニュー] - [新規]をクリックします。

{% screenshot new1.png "[新規]" %}

&#9313; [空のデスクトップデータベース]を選択し、ファイル名入力欄に `Clist` と入力し[作成]をクリックします。

{% screenshot new2.png "[空のデスクトップデータベース]" %}

{% screenshot new3.png "新しいデータベースの作成" %}

&#9314; 新しいデータベースが作成されました。


### テーブルの作成

既にテーブルが開かれているのでこれを編集していきます。

&#9312; まず、デザインビューに切り替えます。[ホーム]リボン - [表示] - [デザインビュー]をクリックします。

&#9313; 名前を付けて保存ウィンドウが表示されるので `サークル名簿` と入力し、[OK]をクリックします。

{% screenshot field1.png "名前を付けて保存" %}

{% screenshot field2.png "保存後" %}

&#9314; フィールド名の項目に以下の 11 個の要素を入力していきます。

-   会員ID（すでに `ID` と入力されている部分を `会員ID` に変更します。）
-   氏名
-   フリガナ
-   郵便番号
-   都道府県
-   市区町村
-   携帯TEL
-   入会年月日
-   学年ID
-   学部学科コース
-   退会

{% screenshot field3.png "入力後" %}

これでフィールド名の入力が終わりました。次に、データを入力する際に便利な機能を各フィールドに付与していきます。


### ふりがなウィザードでプロパティを設定

&#9312; "氏名"をクリック - フィールドプロパティのふりがなの項目をクリックします。横に表示された[&hellip;]というボタンをクリックします。

{% screenshot furigana1.png "ふりがなウィザード 起動手順" %}

&#9313; 警告が出るのでテーブルを保存します。

{% screenshot furigana2.png "ふりがなウィザード 警告" %}

&#9314; ふりがなウィザードの"既存のフィールドを使用する"にチェックを入れ、[フリガナ]を選択します。

&#9315; さらにふりがなの文字種に[全角カタカナ]を選択し、[完了]をクリックします。

{% screenshot furigana3.png "ふりがなウィザード 設定内容" %}

&#9316; フィールドのプロパティを変更します。[OK]をクリックします。

{% screenshot furigana4.png "ふりがなウィザード 確認メッセージ" %}

これで、"氏名"のフィールドに入力すると、"フリガナ"のフィールドに全角カタカナでふりがなが入力されるようになりました。


### 住所入力支援ウィザードでプロパティを設定

&#9312; "郵便番号"をクリック - フィールドプロパティの住所入力支援の項目をクリックします。横に表示された[&hellip;]をクリックします。

{% screenshot zipcode1.png "住所入力支援ウィザード 起動手順" %}

&#9313; 住所入力支援ウィザードの郵便番号に[郵便番号]を選択 - [次へ]をクリックします。

{% screenshot zipcode2.png "郵便番号列の設定" %}

&#9314; 住所の構成の中から"都道府県と住所の 2 分割"にチェック - 都道府県に[都道府県]を選択 - 住所に[市区町村]を選択 - [次へ]をクリックします。

{% screenshot zipcode3.png "住所の構成設定" %}

"郵便番号"に自分の家の郵便番号を入力してみましょう。"都道府県"と"市区町村"に住所が表示されます。

&#9315; [完了]をクリックします。

{% screenshot zipcode4.png "動作確認" %}

&#9316; フィールドのプロパティを変更します。[OK]をクリックします。

{% screenshot zipcode5.png "変更保存" %}

上で試したように、これで"郵便番号"を入力すると、"都道府県"と"市区町村"に住所が入力されるようになりました。


### フィールドサイズの変更

&#9312; "学年ID"をクリック - フィールドサイズを `255` から `5` と入力し直します。

{% screenshot fieldsize.png "[学年ID]のフィールドサイズを5に修正" %}


### IMEモードの変更

&#9312; "携帯TEL"をクリック - IME 入力モードを[オン]から[オフ]に変更します。

{% screenshot tel1.png "[携帯TEL]のIME 入力モードを[オフ]に変更" %}

これで"携帯TEL"に入力しようとしたとき、日本語入力がオフになります。


### 定型入力プロパティの設定

&#9312; "入会年月日"の右横にある"テキスト型"を"日付/時刻型"に変更します。

{% screenshot join1.png "[入会年月日]の[テキスト型]を[日付/時刻型]に変更" %}

&#9313; "入会年月日"をクリック - 定型入力の項目をクリック - 横に表示された[&hellip;]をクリックします。

{% screenshot join2.png "定型入力の設定" %}

&#9314; 警告が出るのでテーブルを保存します。

{% screenshot join3.png "保存の警告" %}

&#9315; 定型入力名の中の[日付（S）]を選択 - [次へ]をクリックします。

{% screenshot join4.png "[日付（S）]を選択" %}

&#9316; さらに、[次へ] - [完了]をクリックします。

{% screenshot join5.png "形式の設定" %}

{% screenshot join6.png "完了画面" %}

これで、"入会年月日"に入力したとき、年/月/日の形で入力されるようになりました。


### データ型の変更

&#9312; "学年ID"の右横にある"テキスト型"を"数値型"に変更します。

{% screenshot grade1.png "[学年ID]の[テキスト型]を[数値型]に変更" %}

&#9313; 次に、"退会"の右横にある"テキスト型"を"Yes/No型"に変更します。

{% screenshot quit1.png "[退会]の右横にある[テキスト型]を[Yes/No型]に変更" %}

&#9314; "退会"をクリック - [ルックアップ]タブの"表示コントロール"を"チェックボックス"に変更します。

{% screenshot quit2.png "[ルックアップ]タブ [表示コントロール]を[チェックボックス]に変更" %}


### データの入力

&#9312; [ホーム]リボン - [表示] - ![](./pic/databaseview.png)（データシートビュー）をクリックして、データシートビューに戻ります。
以下のデータを入力してみてください。

-   氏名：山本浩史（ヤマモト ヒロシ）
-   郵便番号：221-0023
-   市区町村：横浜市神奈川区宝町5-5-0
-   携帯TEL：090-5231-0000
-   入会年月日：2018/09/01
-   学年ＩＤ：1
-   学部学科コース：理学部生命科学科

{% screenshot yamamoto1.png "データシートビュー" %}


### Excelデータのインポート

&#9312; まず、サークル名簿を開いていたら、"サークル名簿"タブを右クリックして閉じます。

&#9313; [外部データ]リボン - [インポートとリンク] - ![](./pic/excelimport.png)をクリックします。

{% screenshot excelimport1.png "Excelアイコンの場所" %}

&#9314; [参照]ボタンをクリックし、先ほどダウンロードした"Clist.xlsx"を選択します。

&#9315; "レコードのコピーを次のテーブルに追加する"にチェックを入れ、"サークル名簿"を選択し、[OK]をクリックします。

{% screenshot excelimport2.png "外部データの取り込み" %}

&#9316; [次へ]をクリックします。

{% screenshot excelimport3.png "スプレッドシート インポート ウィザード" %}

&#9317; [完了]をクリックします。

{% screenshot excelimport4.png "完了画面" %}

&#9318; [閉じる]をクリックしてインポートを完了します。

{% screenshot excelimport5.png "外部データの取り込み 完了画面" %}

このようにExcelのファイル内に保存されているデータをAccessにインポートすることができます。

{% screenshot excelimport6.png "データシートビュー インポート後" %}


### Accessテーブルのインポート

&#9312; [外部データ]タブ - [インポート] - ![](./pic/accessimport.png)をクリックします。

{% screenshot accessimport1.png "Accessアイコンの場所" %}

&#9313; [参照]ボタンをクリックし、先ほどダウンロードした"gradetype.accdb"を選択し、[OK]をクリックします。

{% screenshot accessimport2.png "外部データの取り込み" %}

&#9314; "月会費"を選択 - [OK]をクリックします。

{% screenshot accessimport3.png "オブジェクトのインポート" %}

&#9315; [閉じる]をクリックしてインポートを完了します。

{% screenshot accessimport4.png "外部データの取り込み 完了画面" %}

"月会費"テーブルがインポートされました。

{% screenshot accessimport5.png "インポート後" %}

このように元々作られていたAccessのテーブルをインポートし、クエリを用いて関連づけをすることができます。


課題
----

学会の入会日リストを管理するデータベースを作成し、"会員名簿"テーブルを作成します。
テーブルのデータはExcelファイルからインポートします。以下の指示に従って、作成してください。

1. 空の"会員管理"データベースを作成してください。名称は"congress"にしてください。
2. 次のフィールドを含む"会員名簿"テーブルを作成してください。
    -   テーブル名：会員名簿
    -   フィールド名：氏名、シメイ、郵便番号、都道府県、市区町村、自宅TEL、入会年月日、会員タイプ、職種、退会
    -   フィールド名の変更：ＩＤ　→　会員ＩＤ
    -   主キー：自動的に設定される
3. "氏名"フィールドに氏名を入力すると、"シメイ"フィールドに全角カタカナのフリガナが自動的に表示されるようにしてください。
4. "郵便番号"フィールドに郵便番号を入力すると、住所が"都道府県"フィールドと"市区町村"フィールドに自動的に表示されるように設定してください。
5. "自宅TEL"フィールドのIME入力モードプロパティをオフに設定してください。
6. "入会年月日"フィールドの定型入力プロパティにデータ入力時の書式として日付（Ｓ）（年／月／日）を設定してください。
7. デザインビューで以下のフィールドを設定してください。
    -   "入会年月日"フィールドのデータ型は[日付／時刻型]
    -   "会員タイプ"フィールドのデータ型は[数値型]
    -   "退会"フィールドのデータ型は[Yes／No型]
8. "会員名簿"テーブルに、Excelファイルの"congress.xlsx"からデータをインポートしてください。
9. 新規レコードに次のデータを入力してください。
    -   会員ＩＤ：21（自動入力）
    -   氏名：佐川亮子
    -   フリガナ：サガワリョウコ（自動入力）
    -   郵便番号：160-0022
    -   都道府県：東京都（自動入力）
    -   市区町村：新宿区新宿6-6-0（自動入力だが、番地は手入力する）
    -   自宅TEL：03-3330-0000
    -   入会年月日：2014/09/26
    -   会員タイプ：2
    -   職種：大学生
    -   退会：オフ
10. "会員管理"データベースにaccessファイル"membertype.accdb"データベースの"会員タイプ"テーブルをインポートしてください。
