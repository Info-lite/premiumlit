---
layout: page
title: 表計算２
date: 2016-03-15 17:02:54 +0900
purposes:
    - 簡単な数式
    - 絶対参照・相対参照
    - 関数の利用（１）：SUM, AVERAGE など
flowplayer_conf:
    - embed: false
    - ratio: 0.75
---


数式と関数、絶対参照と相対参照
------------------------

**関数**、**絶対参照と相対参照**は、Excelを初めとする表計算ソフトにおいて、とても重要な機能の一つです。
関数を用いることで、色々な種類の複雑な計算を一瞬で導き出すことができます。
また、絶対参照と相対参照を行うことによって、無限に続くとも思える数値を入力せずに計算を行うことができます。

次のファイルをダウンロードして、Excelで開いてください。そして、表を完成させてみましょう。

-   [いちご狩りファイル(ichigo.xlsx)](./ichigo.xlsx)

{% screenshot itigo.png "いちご狩りファイルの初期状態" %}
   
{% screencast function_insert "関数の使い方" %}

### 数式処理

数式処理はセルの先頭が（半角の）`=` で始まります。これをセルに直接入力、もしくは数式バーから入力します。

{% screenshot formula1.png "数式入力例" %}

Excelで用いる主な算術演算子は以下のようなものがあります。

-   `+` : 加算
-   `-` : 減算
-   `*` : 乗算
-   `/` : 除算
-   `^` : べき乗
-   `%` : パーセント

演算の優先順位は、基本的には通常通りですが、括弧 `()` を用いることもできます。また、これ以外にも多くの関数による演算が可能です。

{% appendix ../appendix/enzanshi.html "演算子についての補足" %}

<!--
### 総和計算

 次項とのつながりがおかしい 

{% screencast autosum "オートSUM" %}

続いて男、女の総計(Sum)を "C13"、"D13" に計算していれます。"C13"を選択し、以下に示すような[オート SUM]ボタンをクリックします。

{% screenshot population4.png "オートSUM（ポップヒント：オートSUM）" %}

総和が "C13" に自動的にはいります。女のデータも同様に行いましょう。これで男女の総計も計算されます。

{% screenshot populationfinal.png "オートSUMの結果" %}

{% appendix ../appendix/function.html "Microsoft Excelで使える関数" %}
-->

### SUM関数

    =SUM(数値1,[数値2],...)

`()` 内の数値の総和を出す関数です。

&#9312; まず、各人のいちごの"合計(g)"を求めます。前回説明していますので、復習のつもりでやってみましょう。 "F3" を選択します。

&#9313; 次に[ホーム]リボン - [編集]タブ - [オート SUM]をクリックします。

{% screenshot sum1.png "オートSUM（ポップヒント：オートSUM）" %}

&#9314; すると、自動的に選択範囲が関数に入力されます。[Enter]を押すと、総和が "F3" に入力されます。

{% screenshot sum2.png "オートSUMを押した結果" %}

### 相対参照

&#9312; オートフィルを使って、全ての合計を出します。選択したセルの右下にある[■]の上にカーソルを持って行き、一気に "F12" まで引き延ばします。

{% screenshot sum3.png "計算結果のオートフィル：十字カーソル合わせ" %}

{% screenshot sum4.png "計算結果のオートフィル：下までドラッグ" %}

&#9313; ところでExcelの数式の部分に注目します。

{% screenshot sum5.png "数式バー" %}

&#9314; 次に "F12" に選択します。すると、数式が変わりました。

{% screenshot sum7.png "数式の自動変化" %}

{% screenshot sum6.png "数式の自動変化（注目）" %}

オートフィルはコピー＆ペーストと同じ機能を果たしています。
しかし、ペーストされたのは、セル番号が違う数式です。
つまり、コピーされたセルに記録されていたのは、セル番号ではなく、セルの位置です。
これが**相対参照**です。

相対参照は入力されているセルを基点として、各セルの位置を記録しておく参照方法です。
そのため、コピー＆ペーストした結果、ペーストされたセルから同じだけ移動した位置にあるセルを参照します。

{% screenshot sum8.png "参照部分の自動移動" %}

### AVERAGE関数

    =AVERAGE(数値1,[数値2],...)

`()`内の数値の平均を出す関数です。

&#9312; 各人が平均でどのくらいのいちごを採ったのか、調べてみましょう。まず "E13" を選択し，`平均` と入力します。

&#9313; 次に、"F13" を選択します。[ホーム]リボン - [編集]タブ - [オートSUM]の[▼] - [平均]をクリックします。

{% screenshot average1.png "編集タブから平均を選択" %}

{% screenshot average2.png "平均" %}

&#9314; [Enter]を押します。すると、平均が出てきました。

{% screenshot average3.png "平均計算結果" %}

{% screencast function "関数の使い方" %}

### 絶対参照

&#9312; オートフィルを使って、各人の順位を出します。 "A3" から "A12" まで伸ばします。

&#9313;  "A5" と "A6" 、 "A11" を見てください。`2` が３つあります（緑枠）。これは順位としておかしいので、修正しなくてはなりません。 "A12" を選択して、数式に注目してください。相対参照しているため、RANK関数の範囲がずれていることがわかります。（赤枠がA3の範囲、青枠がA12の範囲を表す）

{% screenshot rank8.png "相対参照の弊害" %}

&#9314; ここで、絶対参照を使って、正しい順位を導き出しましょう。まず "A4" から "A12" までを選択 - 右クリック - [数式と値のクリア]でクリアします。

&#9315;  "A3" を選択します - 数式バーの範囲の部分の "F3" にカーソルを移します - [F4] キーを押します。

{% screenshot rank9.png "参照セルの固定" %}

&#9316; "F3" が "＄F＄3" に変わりました。`$` がついた列・行は、固定された状態になります。これが絶対参照の状態です。同様に "F12" も [F4] キーで絶対参照の状態にします。

&#9317; オートフィルで先ほどと同じように "A3" から "A12" まで伸ばします。

&#9318; 先ほどとは違う結果が出ました。 "A12" を選択して、範囲が変わっていないことを確認してください。

{% screenshot rank10.png "正常化された順位" %}

これが**絶対参照**です。
絶対参照は表計算ソフト上のセル番号で位置を記録しておく参照方法です。
どの位置にあっても、同じセルを参照することができます。
絶対参照と相対参照をうまく使い分けることによって、より便利にExcelを使うことができます。


課題
-----

<!-- 簡単な数式の課題だが、内容は講と一致していない -->

人口統計表を仕上げてください。

1.  "E3" にタイトル `男女差` と入力、"E4" から "E13" まで対応する年代の男女の人口の差を計算してデータを埋めてください
1.  "F3" を `男女比` として各年代の 女性人口 &divide; 男性人口 を計算してください
    -   除算記号は `/` (スラッシュ) です
    -   データの形式を変えるには、"ホーム"リボン内の"数値"パネルを使うと、パーセント表示にすることも出来ます
